
# Skip newer or system-specific unmatched options.
IgnoreUnknown AddKeysToAgent,UseKeychain,ForwardAgent

HashKnownHosts no

{{- if .work }}
Include ~/.ssh/akamai.cfg
Include ~/.ssh/linode.cfg
{{- end }}

Host github-rishid github
    HostName github.com
    User git
    IdentityFile ~/.ssh/github_rishid
    IdentitiesOnly yes

# Defaults for all hosts
Host *
    ControlMaster auto
    ControlPath ~/.ssh/controlmasters/%r@%h:%p
    ControlPersist 60m
    AddKeysToAgent yes
     UseKeychain yes
-    ServerAliveInterval 6
    AddKeysToAgent yes
     UseKeychain yes
-    ServerAliveInterval 60
-    ServerAliveCountMax 30
-    ServerAliveCountMax 3

# 12/6/23 Exclude github as cannot reuse socket since user, host and port are same except key
Host !github.com
    # Accelerate connections by reusing existing connections to the same host.
    ControlMaster auto
    ControlPath ~/.ssh/controlmasters/%r@%h:%p
    ControlPersist 60m

    # Forward SSH agent to remote hosts (for VS Code Remote SSH)
    ForwardAgent yes
    # Allow storing passphrases in the macOS keychain.
    AddKeysToAgent yes
{{- if (eq .chezmoi.os "darwin") }}
    UseKeychain yes
{{- end }}

    # Keep the connection temporarily open by sending a data every few minutes.
    ServerAliveCountMax 6
    ServerAliveInterval 300
